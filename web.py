This code is done from Linux system.
